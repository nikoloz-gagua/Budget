<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Static budget planner for GitHub Pages with monthly planning, templates, and forecasting.">
  <title>Budget Atlas</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="app-shell">
    <aside class="sidebar" aria-label="Primary navigation">
      <div class="brand">
        <div class="brand-mark" aria-hidden="true">BA</div>
        <div>
          <div class="brand-title">Budget Atlas</div>
          <div class="brand-subtitle">Plan first. Spend clearly.</div>
        </div>
      </div>

      <div class="month-panel">
        <div class="month-panel-label">Active month</div>
        <div class="month-panel-row">
          <button type="button" class="icon-btn" data-action="change-month" data-dir="-1" aria-label="Previous month">
            <span aria-hidden="true">&lt;</span>
          </button>
          <div class="month-panel-value" id="globalMonthLabel">Month</div>
          <button type="button" class="icon-btn" data-action="change-month" data-dir="1" aria-label="Next month">
            <span aria-hidden="true">&gt;</span>
          </button>
        </div>
      </div>

      <nav class="nav">
        <button type="button" class="nav-btn active" data-page="dashboard">
          <span class="nav-btn-label">Dashboard</span>
          <span class="nav-btn-meta">Overview and forecast</span>
        </button>
        <button type="button" class="nav-btn" data-page="planner">
          <span class="nav-btn-label">Planner</span>
          <span class="nav-btn-meta">Monthly allocations</span>
        </button>
        <button type="button" class="nav-btn" data-page="transactions">
          <span class="nav-btn-label">Transactions</span>
          <span class="nav-btn-meta">Income and expenses</span>
        </button>
        <button type="button" class="nav-btn" data-page="goals">
          <span class="nav-btn-label">Goals</span>
          <span class="nav-btn-meta">Savings targets</span>
        </button>
        <button type="button" class="nav-btn" data-page="settings">
          <span class="nav-btn-label">Settings</span>
          <span class="nav-btn-meta">Backup and profile</span>
        </button>
      </nav>

      <div class="sidebar-note">
        Static app for GitHub Pages. All data stays in your browser local storage unless exported.
      </div>
    </aside>

    <main class="main" id="appMain">
      <header class="topbar">
        <div class="topbar-left">
          <button type="button" class="mobile-menu-btn" id="mobileMenuButton" aria-label="Toggle navigation">
            Menu
          </button>
          <div>
            <h1 class="topbar-title" id="pageTitle">Dashboard</h1>
            <p class="topbar-subtitle" id="pageSubtitle">Overview and forecast</p>
          </div>
        </div>
        <div class="topbar-actions">
          <button type="button" class="btn btn-ghost" data-action="open-transaction-modal">Add transaction</button>
          <button type="button" class="btn btn-primary" data-action="goto-page" data-page="planner">Open planner</button>
        </div>
      </header>

      <section class="page is-active" id="page-dashboard" aria-labelledby="pageTitle">
        <div class="hero">
          <div class="hero-copy">
            <p class="eyebrow">Monthly command center</p>
            <h2 id="dashHeroTitle">Budget dashboard</h2>
            <p id="dashHeroText" class="hero-text">Track plan vs actual spending and forecast the rest of the month.</p>
            <div class="hero-pills">
              <span class="pill" id="heroPillStatus">Plan status</span>
              <span class="pill" id="heroPillAllowance">Daily allowance</span>
            </div>
          </div>
          <div class="hero-panel">
            <div class="hero-panel-label">Available to spend</div>
            <div class="hero-panel-value" id="heroAvailableValue">$0.00</div>
            <div class="hero-panel-meta" id="heroAvailableMeta">Build your month plan to unlock guidance.</div>
            <div class="hero-progress">
              <div class="hero-progress-track">
                <div class="hero-progress-fill" id="heroProgressFill"></div>
              </div>
              <div class="hero-progress-caption" id="heroProgressCaption">0% of planned category budget spent</div>
            </div>
          </div>
        </div>

        <div class="kpi-grid" id="dashboardKpis">
          <article class="metric-card"><h3>Planned income</h3><p id="kpiPlannedIncome">$0.00</p><small id="kpiPlannedIncomeSub">From monthly income plan</small></article>
          <article class="metric-card"><h3>Actual income</h3><p id="kpiActualIncome">$0.00</p><small id="kpiActualIncomeSub">Transactions this month</small></article>
          <article class="metric-card"><h3>Actual expenses</h3><p id="kpiActualExpense">$0.00</p><small id="kpiActualExpenseSub">All expense transactions</small></article>
          <article class="metric-card"><h3>Unallocated</h3><p id="kpiUnallocated">$0.00</p><small id="kpiUnallocatedSub">Planned income minus planned allocations</small></article>
          <article class="metric-card"><h3>Projected month-end spend</h3><p id="kpiProjectedExpense">$0.00</p><small id="kpiProjectedExpenseSub">Pacing forecast</small></article>
          <article class="metric-card"><h3>Actual net cash</h3><p id="kpiActualNet">$0.00</p><small id="kpiActualNetSub">Income minus expenses</small></article>
        </div>

        <div class="dashboard-grid">
          <section class="panel panel-large">
            <div class="panel-head">
              <div>
                <h3>6-Month cashflow trend</h3>
                <p class="panel-sub">Income and expenses by month</p>
              </div>
            </div>
            <div id="trendChart" class="trend-chart" aria-live="polite"></div>
            <div class="legend">
              <span><i class="legend-swatch income"></i>Income</span>
              <span><i class="legend-swatch expense"></i>Expense</span>
              <span><i class="legend-swatch net"></i>Net</span>
            </div>
          </section>

          <section class="panel">
            <div class="panel-head">
              <div>
                <h3>Category health</h3>
                <p class="panel-sub">Plan, actual, remaining, and forecast</p>
              </div>
              <button type="button" class="text-btn" data-action="goto-page" data-page="planner">Open planner</button>
            </div>
            <div id="dashCategoryList" class="category-health-list"></div>
          </section>

          <section class="panel">
            <div class="panel-head">
              <div>
                <h3>Forecast and alerts</h3>
                <p class="panel-sub">Pacing, overspending, and plan gaps</p>
              </div>
            </div>
            <div id="dashInsights" class="insight-list"></div>
          </section>

          <section class="panel">
            <div class="panel-head">
              <div>
                <h3>Recent transactions</h3>
                <p class="panel-sub">Latest activity in the active month</p>
              </div>
              <button type="button" class="text-btn" data-action="goto-page" data-page="transactions">View all</button>
            </div>
            <div id="dashRecentTransactions" class="transaction-list compact"></div>
          </section>
        </div>
      </section>

      <section class="page" id="page-planner">
        <div class="page-grid">
          <section class="panel panel-span-2">
            <div class="panel-head">
              <div>
                <h3>Monthly budget plan</h3>
                <p class="panel-sub">Template-driven planning with monthly snapshots and rollovers</p>
              </div>
              <div class="toolbar">
                <button type="button" class="btn btn-ghost" data-action="copy-prev-plan">Copy previous month</button>
                <button type="button" class="btn btn-ghost" data-action="apply-template-defaults">Apply template defaults</button>
                <button type="button" class="btn btn-ghost" data-action="auto-balance-plan">Auto-balance remainder</button>
                <button type="button" class="btn btn-primary" data-action="close-month">Close month + roll forward</button>
              </div>
            </div>
            <div class="summary-strip" id="plannerSummaryStrip"></div>
            <div class="planner-layout">
              <div class="stack">
                <section class="subpanel">
                  <div class="subpanel-head">
                    <h4>Income plan</h4>
                    <button type="button" class="btn btn-ghost btn-small" data-action="add-income-item">Add source</button>
                  </div>
                  <div id="incomePlanRows" class="editable-list"></div>
                  <div class="subpanel-foot">
                    <div class="foot-row">
                      <span>Total planned income</span>
                      <strong id="incomePlanTotal">$0.00</strong>
                    </div>
                  </div>
                </section>

                <section class="subpanel">
                  <div class="subpanel-head">
                    <h4>Reserves and notes</h4>
                  </div>
                  <div class="form-grid two-col">
                    <label class="field">
                      <span>Buffer</span>
                      <input type="number" id="planBufferInput" min="0" step="0.01" placeholder="0.00">
                    </label>
                    <label class="field">
                      <span>Savings target (general)</span>
                      <input type="number" id="planSavingsTargetInput" min="0" step="0.01" placeholder="0.00">
                    </label>
                    <label class="field full">
                      <span>Planner notes</span>
                      <textarea id="planNotesInput" rows="3" placeholder="Monthly strategy, reminders, or constraints"></textarea>
                    </label>
                  </div>
                </section>

                <section class="subpanel">
                  <div class="subpanel-head">
                    <h4>Goal contributions</h4>
                    <button type="button" class="btn btn-ghost btn-small" data-action="goto-page" data-page="goals">Manage goals</button>
                  </div>
                  <div id="goalAllocationRows" class="goal-plan-list"></div>
                </section>
              </div>

              <div class="stack">
                <section class="subpanel">
                  <div class="subpanel-head">
                    <h4>Category allocations</h4>
                    <div class="toolbar">
                      <button type="button" class="btn btn-ghost btn-small" data-action="open-template-modal">New template category</button>
                      <button type="button" class="btn btn-ghost btn-small" data-action="add-custom-allocation-row">Add one-off row</button>
                    </div>
                  </div>
                  <div class="table-wrap">
                    <table class="planner-table">
                      <thead>
                        <tr>
                          <th>Category</th>
                          <th>Type</th>
                          <th>Priority</th>
                          <th>Planned</th>
                          <th>Carry-in</th>
                          <th>Actual</th>
                          <th>Remaining</th>
                          <th>Forecast</th>
                          <th>Variance</th>
                          <th>Roll</th>
                          <th></th>
                        </tr>
                      </thead>
                      <tbody id="allocationTableBody"></tbody>
                    </table>
                  </div>
                </section>
              </div>
            </div>
          </section>

          <section class="panel">
            <div class="panel-head">
              <div>
                <h3>Recurring templates</h3>
                <p class="panel-sub">These seed future month plans</p>
              </div>
              <button type="button" class="text-btn" data-action="open-template-modal">Add template</button>
            </div>
            <div id="templateList" class="template-list"></div>
          </section>
        </div>
      </section>

      <section class="page" id="page-transactions">
        <div class="panel">
          <div class="panel-head">
            <div>
              <h3>Transactions</h3>
              <p class="panel-sub">Logged activity for the active month</p>
            </div>
            <div class="toolbar">
              <button type="button" class="btn btn-ghost" data-action="set-tx-filter" data-filter="all">All</button>
              <button type="button" class="btn btn-ghost" data-action="set-tx-filter" data-filter="income">Income</button>
              <button type="button" class="btn btn-ghost" data-action="set-tx-filter" data-filter="expense">Expense</button>
              <button type="button" class="btn btn-primary" data-action="open-transaction-modal">Add transaction</button>
            </div>
          </div>
          <div class="transactions-toolbar">
            <label class="field">
              <span>Search</span>
              <input type="search" id="txSearchInput" placeholder="Description, category, note">
            </label>
          </div>
          <div id="transactionsList" class="transaction-list"></div>
        </div>
      </section>

      <section class="page" id="page-goals">
        <div class="panel">
          <div class="panel-head">
            <div>
              <h3>Savings goals</h3>
              <p class="panel-sub">Track progress and plan monthly contributions</p>
            </div>
            <button type="button" class="btn btn-primary" data-action="open-goal-modal">Add goal</button>
          </div>
          <div id="goalsList" class="goal-grid"></div>
        </div>
      </section>

      <section class="page" id="page-settings">
        <div class="page-grid">
          <section class="panel">
            <div class="panel-head">
              <div>
                <h3>Profile</h3>
                <p class="panel-sub">Customize labels and formatting</p>
              </div>
            </div>
            <div class="form-grid">
              <label class="field full">
                <span>Name</span>
                <input type="text" id="settingNameInput" placeholder="e.g. Alex">
              </label>
              <label class="field">
                <span>Currency symbol</span>
                <input type="text" id="settingCurrencyInput" placeholder="$" maxlength="4">
              </label>
              <label class="field">
                <span>Locale</span>
                <input type="text" id="settingLocaleInput" placeholder="en-US">
              </label>
            </div>
          </section>

          <section class="panel">
            <div class="panel-head">
              <div>
                <h3>Data and backup</h3>
                <p class="panel-sub">Import/export JSON with schema migration support</p>
              </div>
            </div>
            <div class="stack">
              <div class="toolbar">
                <button type="button" class="btn btn-ghost" data-action="export-data">Export JSON</button>
                <button type="button" class="btn btn-ghost" data-action="import-data-click">Import JSON</button>
                <button type="button" class="btn btn-danger" data-action="clear-data">Clear all data</button>
              </div>
              <input type="file" id="importFileInput" accept=".json,application/json" hidden>
              <div class="info-box">
                <div class="info-box-title">GitHub Pages ready</div>
                <p>This app is fully static. It stores data in browser local storage and runs without any backend.</p>
                <p id="schemaInfoText">Schema version: 2</p>
              </div>
            </div>
          </section>
        </div>
      </section>
    </main>
  </div>

  <div class="modal-backdrop" id="txModal" hidden>
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="txModalTitle">
      <div class="modal-head">
        <h3 id="txModalTitle">Add transaction</h3>
        <button type="button" class="icon-btn" data-action="close-modal" data-modal="txModal" aria-label="Close transaction modal">x</button>
      </div>
      <form id="txForm" class="form-grid">
        <input type="hidden" id="txEditId">
        <label class="field">
          <span>Type</span>
          <select id="txTypeInput">
            <option value="expense">Expense</option>
            <option value="income">Income</option>
          </select>
        </label>
        <label class="field">
          <span>Date</span>
          <input type="date" id="txDateInput" required>
        </label>
        <label class="field">
          <span>Amount</span>
          <input type="number" id="txAmountInput" min="0.01" step="0.01" placeholder="0.00" required>
        </label>
        <label class="field">
          <span>Category</span>
          <input type="text" id="txCategoryInput" list="txCategoryOptions" placeholder="e.g. Food" required>
          <datalist id="txCategoryOptions"></datalist>
        </label>
        <label class="field full">
          <span>Description</span>
          <input type="text" id="txDescriptionInput" placeholder="What was this for?">
        </label>
        <label class="field full">
          <span>Note</span>
          <textarea id="txNoteInput" rows="3" placeholder="Optional details"></textarea>
        </label>
        <div class="modal-actions full">
          <button type="button" class="btn btn-ghost" data-action="close-modal" data-modal="txModal">Cancel</button>
          <button type="submit" class="btn btn-primary">Save transaction</button>
        </div>
      </form>
    </div>
  </div>

  <div class="modal-backdrop" id="templateModal" hidden>
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="templateModalTitle">
      <div class="modal-head">
        <h3 id="templateModalTitle">Template category</h3>
        <button type="button" class="icon-btn" data-action="close-modal" data-modal="templateModal" aria-label="Close template modal">x</button>
      </div>
      <form id="templateForm" class="form-grid">
        <input type="hidden" id="templateEditId">
        <label class="field full">
          <span>Category name</span>
          <input type="text" id="templateNameInput" placeholder="e.g. Groceries" required>
        </label>
        <label class="field">
          <span>Type</span>
          <select id="templateTypeInput">
            <option value="variable">Variable</option>
            <option value="fixed">Fixed</option>
            <option value="sinking">Sinking fund</option>
          </select>
        </label>
        <label class="field">
          <span>Priority</span>
          <select id="templatePriorityInput">
            <option value="must">Must pay</option>
            <option value="should">Should pay</option>
            <option value="nice">Nice to have</option>
          </select>
        </label>
        <label class="field">
          <span>Default monthly target</span>
          <input type="number" id="templateAmountInput" min="0" step="0.01" placeholder="0.00" required>
        </label>
        <label class="field checkbox-field">
          <input type="checkbox" id="templateRolloverInput">
          <span>Carry positive remaining balance to next month</span>
        </label>
        <div class="modal-actions full">
          <button type="button" class="btn btn-ghost" data-action="close-modal" data-modal="templateModal">Cancel</button>
          <button type="submit" class="btn btn-primary">Save template</button>
        </div>
      </form>
    </div>
  </div>

  <div class="modal-backdrop" id="goalModal" hidden>
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="goalModalTitle">
      <div class="modal-head">
        <h3 id="goalModalTitle">Savings goal</h3>
        <button type="button" class="icon-btn" data-action="close-modal" data-modal="goalModal" aria-label="Close goal modal">x</button>
      </div>
      <form id="goalForm" class="form-grid">
        <input type="hidden" id="goalEditId">
        <label class="field full">
          <span>Goal name</span>
          <input type="text" id="goalNameInput" placeholder="e.g. Emergency fund" required>
        </label>
        <label class="field">
          <span>Target amount</span>
          <input type="number" id="goalTargetInput" min="0.01" step="0.01" required>
        </label>
        <label class="field">
          <span>Saved so far</span>
          <input type="number" id="goalSavedInput" min="0" step="0.01" placeholder="0.00">
        </label>
        <label class="field">
          <span>Deadline</span>
          <input type="date" id="goalDeadlineInput">
        </label>
        <div class="modal-actions full">
          <button type="button" class="btn btn-ghost" data-action="close-modal" data-modal="goalModal">Cancel</button>
          <button type="submit" class="btn btn-primary">Save goal</button>
        </div>
      </form>
    </div>
  </div>

  <div class="toast" id="toast" hidden></div>

  <script src="app.js" defer></script>
</body>
</html>
